# Route Master
#### 고객의 주소 데이터를 받아와 ‘소요시간 or 거리’를 가중치로 두어 최단경로 찾아주어 효율적인 택배배송을 위한 프로그램   
  
</br>

### 사용언어 
- #### C++ or Python
- #### Node.js
- #### html
- #### JavaScript

</br>

## 계획
### 1. 고객의 주소 데이터 확보 
### 2. DB 저장
### 3. 네이버 API 이용
 - #### 주소 위도 경도로 변환
 - #### 위도 경도 바뀐값으로 소요시간 구함
 - #### 주소위치 마커로 표시
### 4. Dijkstra 알고리즘 이용 하여 최단거리 구함 - 가중치 : 소요시간
### 5. 구한 경로 사용자에게 웹 사이트구성하여 제공

</br>

## To Do
1. 고객의 주소 데이터 어떻게 할것인지 
2. 네이버API공부 
(10/11)
- 네이버 클라우드 플랫폼 가입
- application등록 이름 (Route-master)
- 성공 :    
    * get_taketime.py -> 소요시간 구하기  
        출발지에서 목적지까지 378990m 거리이며, 약 16161101분 소요됩니다. 
    * get_latlon.py -> 주소가지고 경도 위도 구하기   
        주소: 충청북도 청주시 서원구 모충로 32
        경도: 127.4677057, 위도: 36.6242653

3. 웹페이지 구성하는법 공부 (Node.js)
4. 

## How to 
1단계로 실제 존재하는 인프라(도로)를 바탕으로 길찾기 문제를 풀어보고, 2단계로 택배 물품을 2개 이상 받았을 때 어떤 순서대로 물품을 배송하면 좋을지


https://yermi.tistory.com/category/%E2%96%A3%20Tools/API%F0%9F%8E%AF?page=1


네이버 맵 가이드
https://navermaps.github.io/maps.js.ncp/docs/naver.maps.html  
https://navermaps.github.io/maps.js.ncp/docs/naver.maps.Map.html#toc4__anchor  

마커찍기
https://lpla.tistory.com/132
# 2023.10.12   
nodejs파일 추가 

모듈 설치   
$ npm install morgan  

$ npm install cookie-parser  

$ npm install express-session  

$ npm install express  
-node_modules/ 폴더 생성 

$ npm install -D nodemon 
-이제 $npm nodemon 하면 중간에 파일 수정해도 변경 사항이 반영됨 

**실행방법**

$ npx nodemon 파일이름.js

- index.html 에 지도 띄우기 만들고 map_site.js로 실행


**계획**  
1. 마커찍기  
    var marker   
    - 맵 가운데도 지정하고 위도 경도 바꿔야함 
    충북대학교 
    (36.629449717767436,127.45769316147752)

2. 왼쪽에 지도 띄우기

    \<div id="map" style="left:100px;width:50\%;height:600px;">  
\</div>
left,right,width,height 가 있고 px,\%가 있다.

3. 오른쪽에 리스트 띄우기 

4. 주소를 받아와서 웹사이트에 넣으면 리스트나 DB에 저장 
- 주소를 일단 임의로 저장하고 딕셔너리를 활용해서 주소랑 좌표를 알기 쉽게 정리해서 보여줄 수 있도록  -> 일단 딕셔너리이용해서 각 주소pair 간에 소요시간이랑 거리 구해서 나타냄 
- 혹은 json이용?

5. 주소 위도경도로 바꿈
- 성공 
6. 바뀐 위도경도로 driving이용해서 소요시간 계산
- 성공 

    문제점 - 모듈 이용해서 각각 함수 가져와서 test파일에서 get_latlon의 address_to_coordinates로 좌표 변환한거 리스트에 넣고 get_taketime의 get_travel_time 써서 거리랑 소요시간 구함. 거리는 m 소요시간은 ms(millisecond(1/1000초)) 

        # 밀리초를 초로 변환
        seconds = milliseconds / 1000

        # 초를 분과 초로 변환
        minutes = seconds // 60  # 분
        remaining_seconds = seconds \% 60  # 초

        이용해서 분 초 로 바꿈 
        
        start_location=coordinate_list[0]
        destination_location=coordinate_list[1] 
        이 자기 맘대로 들어가는듯. -> coordinate_list부터 맘대로 들어가는거임.

        -> 이유 : address_list가 []이 아니라 {}이었음..


7. 소요시간 Dijkstra 알고리즘

Q. python에서 데이터를 어떻게 js에 넣는가?  
A. 1. json형식 사용
2. RESTful API 
3. 데이터베이스 사용


+ 소방서 위치  

청주서부소방서,충청북도 청주시 흥덕구 가경동 1508-2
청주동부소방서,충청북도 청주시 상당구 영운로 61


+ 주소 예시 

충청북도 청주시 서원구 사창동 367-7
충청북도 청주시 서원구 1순환로680번길 13-11
충청북도 청주시 서원구 모충로3번길 26
충청북도 청주시 서원구 내수동로 140
충청북도 청주시 서원구 창직로31번길 12-1  
 address_list=["충청북도 청주시 서원구 사창동 367-7",
               "충청북도 청주시 서원구 1순환로680번길 13-11",
               "충청북도 청주시 서원구 모충로3번길 26",
               "충청북도 청주시 서원구 내수동로 140",
               "충청북도 청주시 서원구 창직로31번길 12-1"]


Q.파이썬 파일 간에 데이터 교류법  
A.모듈이용 
    

    import data_module

    data = data_module.get_shared_data()
    print(data)


**Todo**
1. 웹페이지에 순서 리스트 어떻게 띄울건지 
2. Dijkstra 알고리즘 구현하기 


- distance [845, 441, 976, 462, 1035, 898, 663, 1311, 798, 959]
time [160.112, 102.311, 181.82, 84.446, 188.688, 201.359, 186.535, 214.102, 157.644, 295.018]
충청북도 청주시 서원구 사창동 367-7 - 충청북도 청주시 서원구 1순환로680번길 13-11: 845.00 km
충청북도 청주시 서원구 사창동 367-7 - 충청북도 청주시 서원구 모충로3번길 26: 441.00 km
충청북도 청주시 서원구 사창동 367-7 - 충청북도 청주시 서원구 내수동로 140: 976.00 km
충청북도 청주시 서원구 사창동 367-7 - 충청북도 청주시 서원구 창직로31번길 12-1: 462.00 km
충청북도 청주시 서원구 1순환로680번길 13-11 - 충청북도 청주시 서원구 모충로3번길 26: 1035.00 km
충청북도 청주시 서원구 1순환로680번길 13-11 - 충청북도 청주시 서원구 내수동로 140: 898.00 km
충청북도 청주시 서원구 1순환로680번길 13-11 - 충청북도 청주시 서원구 창직로31번길 12-1: 663.00 km
충청북도 청주시 서원구 모충로3번길 26 - 충청북도 청주시 서원구 내수동로 140: 1311.00 km
충청북도 청주시 서원구 모충로3번길 26 - 충청북도 청주시 서원구 창직로31번길 12-1: 798.00 km
충청북도 청주시 서원구 내수동로 140 - 충청북도 청주시 서원구 창직로31번길 12-1: 959.00 km
충청북도 청주시 서원구 사창동 367-7 - 충청북도 청주시 서원구 1순환로680번길 13-11:  약 2분  40초 소요됩니다.
충청북도 청주시 서원구 사창동 367-7 - 충청북도 청주시 서원구 모충로3번길 26:  약 1분  42초 소요됩니다.
충청북도 청주시 서원구 사창동 367-7 - 충청북도 청주시 서원구 내수동로 140:  약 3분  1초 소요됩니다.
충청북도 청주시 서원구 사창동 367-7 - 충청북도 청주시 서원구 창직로31번길 12-1:  약 1분  24초 소요됩니다.
충청북도 청주시 서원구 1순환로680번길 13-11 - 충청북도 청주시 서원구 모충로3번길 26:  약 3분  8초 소요됩니다.
충청북도 청주시 서원구 1순환로680번길 13-11 - 충청북도 청주시 서원구 내수동로 140:  약 3분  21초 소요됩니다.
충청북도 청주시 서원구 1순환로680번길 13-11 - 충청북도 청주시 서원구 창직로31번길 12-1:  약 3분  6초 소요됩니다.
충청북도 청주시 서원구 모충로3번길 26 - 충청북도 청주시 서원구 내수동로 140:  약 3분  34초 소요됩니다.
충청북도 청주시 서원구 모충로3번길 26 - 충청북도 청주시 서원구 창직로31번길 12-1:  약 2분  37초 소요됩니다.
충청북도 청주시 서원구 내수동로 140 - 충청북도 청주시 서원구 창직로31번길 12-1:  약 4분  55초 소요됩니다.

coordinate= ['127.4633636,36.6289331', '127.4601003,36.6321194', '127.4641923,36.6259632', '127.4625906,36.6341946', '127.4654529,36.6314208']


distance 인접행렬 
[inf, 845, 441, 976, 462]
[845, inf, 1035, 898, 663]
[441, 1035, inf, 1311, 798]
[976, 898, 1311, inf, 959]
[462, 663, 798, 959, inf]
graph = [
    [float('inf'), 845, 441, 976, 462],
    [845, float('inf'), 1035, 898, 663],
    [441, 1035, float('inf'), 1311, 798],
    [976, 898, 1311, float('inf'), 959],
    [462, 663, 798, 959, float('inf')]
]


graph = [[0,0,0,0,0,0],
    [0,float('inf'), 845, 441, 976, 462],
    [0,845, float('inf'), 1035, 898, 663],
    [0,441, 1035, float('inf'), 1311, 798],
    [0,976, 898, 1311, float('inf'), 959],
    [0,462, 663, 798, 959, float('inf')]
]


time 인접행렬
graph = [[0,0,0,0,0,0],
    [0,float('inf'), 160.112, 102.311, 181.82, 84.446],
    [0,160.112, float('inf'), 188.688, 201.359, 186.535],
    [0,102.311, 188.688, float('inf'), 214.102, 157.644],
    [0,181.82, 201.359, 214.102, float('inf'), 295.018],
    [0,84.446, 186.535, 157.644, 295.018, float('inf')]
]


# 2023.10.14

**목표**  
1. 최단경로 구하기위해 Dijkstra 구현

    1.외판원문제 - 완전탐색 알고리즘
    얻은 결과 (time)
    최단 거리: 788.753
    최단 경로: (0, 2, 3, 1, 4)
    
    (distance)
    최단 거리: 3775
    최단 경로: (0, 2, 3, 1, 4)


2. 지도에 마커 표시 

<img src="https://github.com/2dayoung/Route-master/assets/120040559/b61d8975-1322-44de-9096-321dc96dda8f" width=""  height="370">

3. 주소입력창 만들기 

4. .py에서 나온 값 웹에 띄우기 


=======
# 2023.10.17

교수님과 메일   

**idea**  

문제 해결 방법 

1. 네이버 지도로 서로 간 이동하는 시간 또는 거리를 도출함 ( node 5개인 경우 ) 
2. node  5개짜리 완전 그래프 생성
3. 노드와 노드사이에 cost(시간 또는 거리)기록
4. 출발점, 도착점이 정하는것이 필요하면 정함
5. 그래프 문제를 풀기 위해 TSP(traveling salesman problem : 외판원 문제)해결 알고리즘 활용
-cost가 시간인경우 최소시간 택배배송경로, 거리인경우 최소거리 배송경로

문제 응용  

1. cost를 소비 에너지로 할 경우 최소에너지 배송경로도출 가능
2. cost가 시간인 경우 고정된 값이 아니라 배송 시각에 따른 교통량에 따라 달라지는 경로 도출 가능
3. 배송업체 1개가 배송하는것이 아니라 2개 또는 3개의 배송차량이 운행할때 어떻게 문제를 풀 수 있을지 


# 2023.10.18
time으로 [0,0,0,0,0,0]넣어서 인접행렬 
최단 거리: 574.651
최단 경로: (2, 4, 0, 3, 1, 5) ->(1,3,2,0,4)
-마지막 노드에서 출발노드로 돌아가는 거리 추가하는부분 뺌
최단 거리: 373.29200000000003
최단 경로: (2, 5, 1, 3, 0, 4)


distance로 [0,0,0,0,0,0]넣어서 인접행렬 
최단 거리: 2464
최단 경로: (0, 3, 1, 5, 2, 4)
-마지막 노드에서 출발노드로 돌아가는 거리 추가하는부분 뺌
최단 거리: 1566
최단 경로: (2, 5, 1, 3, 0, 4)


0,0,0,0,0 넣어서 (아마 완전탐색?)
distance
최단 거리: 2464
최단 경로: (3, 1, 5, 2, 4)

time 
최단 거리: 574.651
최단 경로: (3, 1, 5, 2, 4)

get_route.py - lin_kernighan 알고리즘 -> 되게 빠름 
결과  ([0,0,0,0]이거 없어야함)
Shortest Length: 2464
Shortest Tour: [2, 0, 4, 1, 3]
Shortest Length: 574.6510000000001
Shortest Tour: [2, 0, 4, 1, 3]

